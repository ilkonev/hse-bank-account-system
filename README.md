# ДЗ 2 - Система финансового учета 

## 1. Общая идея решения

### Реализованный функционал

Основные требования:
- Создание, редактирование и удаление банковских счетов
- Создание, редактирование и удаление категорий (доходы/расходы)
- Добавление финансовых операций (доходы/расходы)

Опциональный функционал:
- Аналитика:
    - Подсчет разницы доходов и расходов за период
    - Группировка операций по категориям
    - Финансовые отчеты
- Экспорт данных: Экспорт в JSON формат
- Статистика: Измерение времени выполнения операций

Дополнительно:
- Добавлена система уведомлений о событиях (изменение баланса, крупные операции)
- Реализовано кэширование данных для повышения производительности
- Добавлена возможность импорта данных из JSON файлов

## 2. Принципы SOLID и GRASP

### SOLID принципы

#### SRP
- BankAccount - отвечает только за данные счета и бизнес-логику операций
- Category - отвечает только за данные категории
- AnalyticsService - отвечает только за аналитику и отчеты
- BalanceNotificationService - отвечает только за уведомления
- Каждая Command отвечает за один пользовательский сценарий

#### OCP
- DataImporter - можно добавить новые форматы импорта без изменения существующего кода
- IFinanceVisitor - можно добавить новые форматы экспорта
- IBalanceObserver - можно добавить новые типы уведомлений

#### LSP
- ObservableBankAccount полностью заменяет BankAccount
- Все репозитории реализуют единые интерфейсы
- Все команды реализуют ICommand

#### ISP
- IBankAccountRepository, ICategoryRepository, IOperationRepository - раздельные интерфейсы
- IBalanceObserver, IOperationObserver - разные аспекты наблюдения

#### DIP
- FinanceFacade зависит от абстракций, а не от конкретных реализаций
- Menu зависит от интерфейсов, а не конкретных классов
- Внедрение зависимостей через конструктор

### GRASP принципы

#### High Cohesion
- Domain слой содержит только доменную логику
- Application слой содержит бизнес-правила и команды
- Infrastructure слой содержит реализации репозиториев
- Example слой содержит консольное меню, то есть UI

#### Low Coupling
- Слои связаны только через интерфейсы
- FinanceFacade уменьшает связанность между клиентом и системой
- События (Observer) уменьшают прямые зависимости

#### Creator
- FinanceEntityFactory создает доменные объекты
- OperationFactory создает операции

#### Controller
- Menu класс обрабатывает пользовательский ввод
- FinanceFacade координирует работу системы

#### Pure Fabrication
- CachedBankAccountRepository - искусственный класс для кэширования
- TimedCommandDecorator - добавление функциональности измерения времени

## 3. Паттерны GoF

### 1) Фасад
- Реализация: FinanceFacade
- Важность: Предоставляет простой унифицированный интерфейс к сложной подсистеме. Скрывает сложность работы с репозиториями, сервисами и командами.

### 2) Команда
- Реализация: ICommand, AddOperationCommand, CreateAccountCommand, CreateCategoryCommand
- Важность: Инкапсуляция запросов как объектов. Позволяет легко добавлять новые операции, логировать выполнение, измерять время.

### 3) Декоратор
- Реализация: TimedCommandDecorator
- Важность: Динамическое добавление функциональности без изменения исходного кода. Соответствует OCP.

### 4) Посетитель
- Реализация: IFinanceVisitor, JsonExportVisitor
- Важность: Добавление операций к объектам без их изменения. Легко расширяется для новых форматов экспорта.

### 5) Шаблонный метод
- Реализация: DataImporter, JsonDataImporter
- Важность: Определение скелета алгоритма с возможностью переопределения шагов. Исключает дублирование кода.

### 6) Фабричный метод
- Реализация: IOperationFactory, OperationFactory
- Важность: Инкапсуляция логики создания объектов. Гарантирует создание валидных объектов.

### 7) Наблюдатель
- Реализация: IBalanceObserver, IOperationObserver, BalanceNotificationService, ObservableBankAccount
- Важность: Создание механизма подписки для уведомлений о событиях. Уменьшает связанность между компонентами.

### 8) Прокси
- Реализация: CachedBankAccountRepository
- Важность: Контроль доступа к объекту с добавлением дополнительной функциональности (кэширование).

## Инструкция по запуску
### Клонирование репозитория
```bash
git clone <repository-url>
cd src
```

### Восстановление зависимостей
```bash
dotnet restore
```

### Запуск приложения
```bash
cd BankAccountSystem.Example
dotnet run
```

### Использование

При запуске откроется главное меню:
1. Создать счет
2. Создать категорию
3. Добавить операцию
4. Показать все счета
5. Финансовый отчет
6. Экспорт данных
7. Демо системы
8. Выход (В меню 0)

Рекомендуемая последовательность действий:
- Создайте счет (пункт 1)
- Создайте категории доходов и расходов (пункт 2)
- Добавьте несколько операций (пункт 3)
- Просмотрите финансовый отчет (пункт 5)
- Протестируйте экспорт данных (пункт 6)
- Запустите демонстрацию системы уведомлений (пункт 7)